incident_response:
  
  document_info:
    chapter: "4.3"
    title: "Incident Response at Scale"
    version: "1.0.0"
    part: "Part IV: Operations"
    author: "Raghav Dinesh"
    github: "github.com/raghavpoonia"
    license: "MIT"
    classification: "Security Operating Manual"
    
    sections_in_this_document:
      - overview
      - core_principles
      - maturity_model
      - building_from_zero
      - ir_framework_and_methodology
      - incident_classification
      - playbook_development
      - investigation_and_forensics
      - containment_strategies
      - communication_and_escalation
      - post_incident_activities
      - tabletop_exercises
      - ir_metrics_and_kpis
      
    core_principles_covered:
      - id: "IR-P001"
        name: "Preparation prevents panic"
      - id: "IR-P002"
        name: "Speed over perfection in containment"
      - id: "IR-P003"
        name: "Evidence preservation enables prosecution"
      - id: "IR-P004"
        name: "Communication clarity prevents chaos"
      - id: "IR-P005"
        name: "Learn from every incident"
      - id: "IR-P006"
        name: "Practice makes perfect"
    
    how_to_use_this_chapter:
      step_1: "Read overview and core principles"
      step_2: "Complete IR maturity self-assessment"
      step_3: "Jump to section matching your maturity level"
      step_4: "Cross-reference with Chapters 2.4, 3.1, 4.1 for complete security operations"
  
  overview: |
    Incident response determines whether security breach becomes minor inconvenience 
    or catastrophic business failure. The difference between ransomware that encrypts 
    10 systems versus 10,000 systems is effective incident response. Between data 
    breach affecting 1,000 records versus 10 million records is incident response speed.
    
    This chapter addresses incident response at enterprise scale: building IR capability 
    from scratch, systematic investigation methodology, containment strategies that 
    limit blast radius, and post-incident learning that strengthens defenses. 
    Organizations with mature IR capability contain breaches in hours instead of weeks, 
    minimize business impact, and emerge stronger from incidents.
    
    Incident response is not just technical procedure - it's crisis management under 
    pressure with legal, regulatory, and business implications. This chapter provides 
    framework for systematic response that balances speed, evidence preservation, 
    stakeholder communication, and business continuity.
    
  core_principles:
    
    preparation_prevents_panic:
      id: "IR-P001"
      maturity_level: "All levels"
      principle: "Preparation and planning before incidents prevents chaotic response during incidents"
      rationale: |
        During active incident, adrenaline flows, stakeholders panic, pressure mounts. 
        Teams without preparation make reactive decisions that worsen situation: destroying 
        evidence, containing wrong systems, communicating conflicting information. 
        Preparation provides playbooks, decision frameworks, communication templates, 
        and practiced procedures that enable calm, effective response under pressure.
      implementation:
        - "Document incident response playbooks before incidents occur"
        - "Maintain updated contact lists and escalation paths"
        - "Pre-stage forensic tools and evidence collection procedures"
        - "Establish legal and PR relationships before needing them"
        - "Conduct tabletop exercises to practice decision-making"
      metrics:
        - "IR playbook coverage: Target >10 common scenarios"
        - "Contact list accuracy: Validated quarterly"
        - "Time to assemble IR team: Target <30 minutes"
        - "Tabletop exercise frequency: Minimum quarterly"
      anti_patterns:
        - "First reading IR playbook during active incident"
        - "Searching for legal counsel contact while ransomware spreading"
        - "Debating evidence collection procedures during breach"
        - "Learning forensic tools for first time during investigation"
      example: |
        Company suffered ransomware attack Friday evening. No IR plan documented. 
        Spent 2 hours finding on-call contacts. Another hour debating whether to 
        pay ransom. Another hour arguing about whether to notify customers. By 
        Monday, ransomware encrypted 80% of systems. Post-incident: Documented 
        playbooks, conducted tabletop exercises. Next incident: Team assembled in 
        20 minutes, containment in 2 hours, business impact minimized by 90%.
        
    speed_over_perfection:
      id: "IR-P002"
      maturity_level: "All levels"
      principle: "Fast containment with incomplete information beats slow containment with perfect information"
      rationale: |
        Every minute attacker remains in environment, damage grows exponentially. 
        Ransomware encrypts more systems. Data exfiltration continues. Lateral 
        movement spreads. Waiting for complete investigation before containment 
        allows attacker to achieve objectives. Effective IR prioritizes rapid 
        containment to stop bleeding, then thorough investigation to understand 
        what happened.
      implementation:
        - "Containment within 1 hour of detection (target)"
        - "Isolate suspected compromised systems immediately"
        - "Block confirmed malicious infrastructure"
        - "Disable compromised accounts"
        - "Deep forensics happens after containment"
      metrics:
        - "Mean time to contain: Target <2 hours"
        - "Percentage of incidents contained within 4 hours: Target >80%"
        - "Business impact reduction through fast containment: Track"
      anti_patterns:
        - "Waiting for complete forensics before containment"
        - "Analysis paralysis during active breach"
        - "Debating containment approach while attacker operates"
        - "Requiring executive approval for emergency containment"
      example: |
        Detection team identified potential credential compromise. Initial investigation 
        incomplete - unsure of scope. Traditional approach: Complete investigation 
        (8 hours), then contain. New approach: Immediate containment (disable account, 
        revoke sessions) within 30 minutes, investigate after containment. Result: 
        Attacker locked out before lateral movement, zero business impact. Investigation 
        revealed would have accessed financial systems if delay occurred.
        
    evidence_preservation:
      id: "IR-P003"
      maturity_level: "Level 2+"
      principle: "Preserve evidence that enables prosecution, attribution, and learning"
      rationale: |
        Evidence determines whether organization can prosecute attackers, prove 
        compliance with notification requirements, learn from incident, and improve 
        defenses. Poor evidence handling destroys forensic artifacts, making 
        investigation impossible. Evidence preservation must balance speed (containment) 
        with forensic soundness (investigation).
      implementation:
        - "Memory dumps before powering off systems"
        - "Disk images before remediation"
        - "Log preservation before rotation"
        - "Chain of custody documentation"
        - "Hash verification of evidence"
      metrics:
        - "Percentage of incidents with complete evidence: Target >90%"
        - "Evidence collection time: Target <2 hours"
        - "Chain of custody documentation: 100%"
      anti_patterns:
        - "Powering off systems before memory capture"
        - "Reimaging systems before forensic analysis"
        - "Allowing evidence tampering through poor custody"
        - "Collecting evidence without documentation"
      example: |
        Ransomware detected. IT immediately reimaged infected systems to restore 
        business operations. No forensic images collected. Investigation impossible: 
        Cannot determine initial access vector, cannot identify all compromised 
        systems, cannot verify complete eradication. Post-incident: Documented 
        evidence collection procedures. Next incident: Forensic images collected 
        before remediation. Complete investigation identified APT, improved defenses, 
        prevented reinfection.
        
    communication_clarity:
      id: "IR-P004"
      maturity_level: "All levels"
      principle: "Clear, consistent communication prevents stakeholder panic and conflicting actions"
      rationale: |
        Incident response involves multiple stakeholders: security team, IT operations, 
        executives, legal, PR, customers, regulators. Without clear communication, 
        stakeholders receive conflicting information, make independent decisions, 
        and create chaos. Single source of truth, defined communication cadence, 
        and role-specific messaging prevents confusion and enables coordinated response.
      implementation:
        - "Single incident commander coordinates all communication"
        - "Regular stakeholder updates (hourly during active incident)"
        - "Separate internal and external communication tracks"
        - "Pre-approved messaging templates for common scenarios"
        - "War room (physical or virtual) for coordination"
      metrics:
        - "Stakeholder satisfaction with communication: Survey post-incident"
        - "Communication frequency: Minimum hourly updates during active response"
        - "Conflicting information incidents: Target = 0"
      anti_patterns:
        - "Multiple people providing different incident updates"
        - "Executives learning about incident from news media"
        - "No communication for hours during active incident"
        - "Technical jargon in external customer communication"
      example: |
        Data breach detected. Security team investigating, IT operations remediating, 
        legal assessing notification requirements, PR drafting customer communication. 
        No coordination: Security said breach contained, IT said ongoing, legal 
        said notify immediately, PR said wait for facts. Customer received 3 different 
        emails with conflicting information. Post-incident: Established incident 
        commander role, single communication source, regular stakeholder syncs. 
        Next incident: Coordinated response, single consistent message, customer 
        trust maintained.
        
    learn_from_every_incident:
      id: "IR-P005"
      maturity_level: "All levels"
      principle: "Every incident reveals security gaps - systematic learning prevents recurrence"
      rationale: |
        Incidents are expensive security education. Organizations that don't learn 
        from incidents repeat same mistakes. Post-incident review identifies root 
        causes, detection gaps, process failures, and improvement opportunities. 
        Systematic learning transforms incidents from failures into security program 
        strengthening opportunities.
      implementation:
        - "Mandatory post-incident review within 1 week"
        - "Blameless culture (focus on process, not people)"
        - "Document findings and action items"
        - "Track remediation completion"
        - "Share lessons learned across organization"
      metrics:
        - "Post-incident reviews completed: Target 100%"
        - "Action items from reviews completed: Target >90%"
        - "Incident recurrence rate: Track reduction"
        - "Time to implement improvements: Target <30 days"
      anti_patterns:
        - "Skipping post-incident review due to time pressure"
        - "Blaming individuals instead of improving processes"
        - "Identifying improvements but never implementing"
        - "Not sharing lessons learned across teams"
      example: |
        Phishing incident led to credential compromise. Post-incident review identified: 
        (1) Users not trained on phishing, (2) No MFA on compromised system, (3) 
        Lateral movement detection gap. Without review, repeat incident likely. 
        With review: Deployed MFA, improved phishing training, added lateral movement 
        detection. Similar attack 3 months later: Detected immediately, zero impact. 
        Learning prevented second successful compromise.
        
    practice_makes_perfect:
      id: "IR-P006"
      maturity_level: "Level 2+"
      principle: "Regular practice through exercises builds muscle memory and reveals gaps"
      rationale: |
        Incident response under pressure requires practiced procedures and clear 
        decision-making. Teams that only respond during real incidents lack muscle 
        memory, miss steps, and make mistakes. Tabletop exercises and simulations 
        build team coordination, reveal playbook gaps, and develop decision-making 
        confidence without business impact of real incident.
      implementation:
        - "Quarterly tabletop exercises for IR team"
        - "Annual full-scale simulation exercises"
        - "Rotate scenarios (ransomware, data breach, insider threat, supply chain)"
        - "Include executives and stakeholders in exercises"
        - "Update playbooks based on exercise findings"
      metrics:
        - "Exercise frequency: Minimum quarterly"
        - "Participant coverage: 100% of IR team annually"
        - "Playbook gaps identified per exercise: Track and remediate"
        - "Decision-making speed improvement: Measure across exercises"
      anti_patterns:
        - "Never practicing incident response until real incident"
        - "Same scenario every exercise (no variety)"
        - "Excluding executives from exercises"
        - "Not updating procedures based on exercise learnings"
      example: |
        IR team documented playbooks but never practiced. Real ransomware incident: 
        Confusion about roles, missed containment steps, poor stakeholder communication. 
        Post-incident: Implemented quarterly tabletop exercises. Next incident: 
        Team executed playbook smoothly, contained in 90 minutes, clear communication. 
        Exercise muscle memory prevented chaos during real crisis.
  
  maturity_model:
    
    purpose: |
      IR maturity determines organizational resilience when breaches occur. This 
      model enables assessment of current IR capability, identification of gaps, 
      and roadmap development. Use self-assessment to determine IR priorities.
    
    maturity_levels:
      
      level_0_reactive_chaos:
        name: "Reactive Chaos"
        characteristics:
          preparation: "No documented IR procedures"
          detection: "Incidents discovered by accident or external notification"
          response: "Ad-hoc decisions, no clear roles"
          communication: "Chaotic, inconsistent messaging"
          learning: "No post-incident review"
        indicators:
          - "No IR plan documented"
          - "No designated IR team"
          - "Incidents discovered by customers or media"
          - "Mean time to contain measured in weeks"
          - "Same incidents repeat"
        risk_level: "Critical - incidents cause catastrophic business impact"
        next_steps: "Document basic IR plan, designate IR team, establish detection capability"
        estimated_timeline: "6-12 months to reach Level 1"
        
      level_1_documented_procedures:
        name: "Documented Procedures"
        characteristics:
          preparation: "Basic IR plan documented"
          detection: "Some detection capability (SIEM alerts)"
          response: "Documented procedures, designated responders"
          communication: "Basic escalation paths defined"
          learning: "Informal lessons learned"
        indicators:
          - "IR plan exists and is accessible"
          - "IR team designated with contact information"
          - "Basic playbooks for common scenarios (3-5)"
          - "Mean time to contain measured in days"
          - "Some post-incident discussion"
        risk_level: "High - procedures exist but untested and incomplete"
        next_steps: "Expand playbook coverage, conduct tabletop exercises, improve detection"
        estimated_timeline: "6-12 months to reach Level 2"
        
      level_2_practiced_response:
        name: "Practiced Response"
        characteristics:
          preparation: "Comprehensive playbooks, regular exercises"
          detection: "Proactive detection and monitoring"
          response: "Practiced procedures, clear roles"
          communication: "Defined communication plan and templates"
          learning: "Formal post-incident reviews with action tracking"
        indicators:
          - "10+ documented playbooks"
          - "Quarterly tabletop exercises"
          - "IR team trained and practiced"
          - "Mean time to contain measured in hours"
          - "Post-incident reviews mandatory with tracked improvements"
        risk_level: "Medium - capable response but improvement opportunities exist"
        next_steps: "Advanced forensics, automation, threat intelligence integration"
        estimated_timeline: "12-18 months to reach Level 3"
        
      level_3_optimized_response:
        name: "Optimized Response"
        characteristics:
          preparation: "Comprehensive playbooks with automation"
          detection: "Advanced detection with threat intelligence"
          response: "Automated response for common scenarios"
          communication: "Seamless stakeholder coordination"
          learning: "Continuous improvement culture, proactive threat hunting"
        indicators:
          - "20+ playbooks with automation integration"
          - "Mean time to detect <4 hours, contain <2 hours"
          - "Automated response for 50%+ of incidents"
          - "Regular red team exercises"
          - "Threat intelligence driving proactive defense"
        risk_level: "Low - mature capability, continuous improvement"
        next_steps: "Industry leadership, threat intelligence sharing, advanced simulations"
        estimated_timeline: "Ongoing optimization"
        
      level_4_proactive_defense:
        name: "Proactive Defense"
        characteristics:
          preparation: "Predictive threat modeling and proactive defense"
          detection: "AI-driven detection, predictive analytics"
          response: "Autonomous response with human oversight"
          communication: "Crisis management excellence"
          learning: "Industry thought leadership, intelligence sharing"
        indicators:
          - "Proactive threat hunting identifies threats before impact"
          - "AI-driven automation handles majority of incidents"
          - "Mean time to detect <1 hour, contain <30 minutes"
          - "Industry recognition for IR capability"
          - "Contributing to community threat intelligence"
        risk_level: "Very Low - industry-leading capability"
        next_steps: "Innovation, research, mentoring other organizations"
        
    self_assessment:
      
      instructions: |
        Answer the following questions about your current IR capability. 
        Score: 1 point for each YES answer. Total score determines maturity level.
        
      questions:
        q1:
          question: "Do you have a documented incident response plan?"
          level_indicator: "Level 0 → Level 1"
          
        q2:
          question: "Do you have a designated incident response team with defined roles?"
          level_indicator: "Level 0 → Level 1"
          
        q3:
          question: "Do you have documented playbooks for common incidents?"
          level_indicator: "Level 0 → Level 1"
          
        q4:
          question: "Do you conduct regular incident response exercises?"
          level_indicator: "Level 1 → Level 2"
          
        q5:
          question: "Do you have mean time to contain under 24 hours?"
          level_indicator: "Level 1 → Level 2"
          
        q6:
          question: "Do you conduct formal post-incident reviews for all incidents?"
          level_indicator: "Level 1 → Level 2"
          
        q7:
          question: "Do you have 10+ documented incident response playbooks?"
          level_indicator: "Level 2 → Level 3"
          
        q8:
          question: "Do you have automated response for common incident types?"
          level_indicator: "Level 2 → Level 3"
          
        q9:
          question: "Do you have mean time to contain under 4 hours?"
          level_indicator: "Level 2 → Level 3"
          
        q10:
          question: "Do you conduct tabletop exercises at least quarterly?"
          level_indicator: "Level 2 → Level 3"
          
        q11:
          question: "Do you have threat intelligence integrated with IR workflows?"
          level_indicator: "Level 2 → Level 3"
          
        q12:
          question: "Do you have mean time to detect under 4 hours?"
          level_indicator: "Level 3 → Level 4"
          
        q13:
          question: "Do you conduct proactive threat hunting?"
          level_indicator: "Level 3 → Level 4"
          
        q14:
          question: "Do you have AI-driven detection and response?"
          level_indicator: "Level 3 → Level 4"
          
      scoring:
        score_0_2:
          level: "Level 0: Reactive Chaos"
          next_section: "building_from_zero"
          priority: "Document IR plan, designate team, establish detection"
          
        score_3_5:
          level: "Level 1: Documented Procedures"
          next_section: "building_from_zero (Phase 2-3)"
          priority: "Expand playbooks, conduct exercises, improve detection"
          
        score_6_8:
          level: "Level 2: Practiced Response"
          next_section: "Advanced playbooks, automation, threat intelligence"
          priority: "Optimize response time, automate common scenarios"
          
        score_9_11:
          level: "Level 3: Optimized Response"
          next_section: "All sections for continuous improvement"
          priority: "Proactive hunting, advanced automation, intelligence sharing"
          
        score_12_14:
          level: "Level 4: Proactive Defense"
          next_section: "Innovation and industry leadership"
          priority: "Research, community contribution, mentoring"
  
  building_from_zero:
    
    audience: "Maturity Level 0-1 organizations building IR capability"
    
    scenario: |
      Starting IR program from scratch: no documented procedures, no designated 
      team, incidents discovered too late. This section provides 12-month roadmap 
      from reactive chaos to practiced incident response capability with documented 
      playbooks and regular exercises.
    
    prerequisites:
      budget: "Estimated $100K-$300K first year (tools, training, external IR retainer)"
      team: "Minimum 2-3 people dedicated to IR (can be part-time initially)"
      executive_support: "CISO and CIO sponsorship for IR investment"
      legal_relationship: "Establish relationship with external legal counsel"
      
    phase_1_foundation:
      
      timeline: "Months 1-3"
      objective: "Establish basic IR capability and documentation"
      maturity_progression: "Level 0 → Level 1"
      
      month_1_team_and_roles:
        
        goal: "Designate IR team and define roles"
        
        core_roles:
          
          incident_commander:
            responsibilities:
              - "Overall incident coordination and decision-making"
              - "Stakeholder communication and escalation"
              - "Resource allocation and prioritization"
            skills_required:
              - "Leadership and decision-making under pressure"
              - "Broad technical understanding"
              - "Strong communication skills"
            time_commitment: "On-call rotation, 100% during active incident"
            
          technical_lead:
            responsibilities:
              - "Technical investigation and forensics"
              - "Containment strategy and execution"
              - "Root cause analysis"
            skills_required:
              - "Deep technical expertise (systems, networks, security)"
              - "Forensics and investigation skills"
              - "Scripting and automation"
            time_commitment: "On-call rotation, 100% during active incident"
            
          communications_lead:
            responsibilities:
              - "Internal and external communication"
              - "Stakeholder updates and messaging"
              - "Documentation and reporting"
            skills_required:
              - "Excellent written and verbal communication"
              - "Stakeholder management"
              - "Crisis communication experience"
            time_commitment: "On-call rotation, activated during incidents"
            
          legal_liaison:
            responsibilities:
              - "Legal implications assessment"
              - "Regulatory notification requirements"
              - "Evidence preservation oversight"
            skills_required:
              - "Legal or compliance background"
              - "Understanding of breach notification laws"
            time_commitment: "Consulted as needed during incidents"
            
        team_size_by_org:
          small_100_employees:
            core_team: "2-3 people (multi-role)"
            extended_team: "IT operations, external IR retainer"
          medium_1000_employees:
            core_team: "5-7 people (dedicated roles)"
            extended_team: "IT, legal, PR, external forensics"
          large_10000_plus:
            core_team: "10-15 people (multiple per role)"
            extended_team: "Full CSIRT with 24/7 coverage"
            
        on_call_rotation:
          structure: "Primary and backup responder for each role"
          schedule: "Weekly rotation"
          escalation: "Backup contacted if primary doesn't respond in 15 minutes"
          compensation: "On-call pay or comp time"
          
      month_2_ir_plan_documentation:
        
        goal: "Document comprehensive incident response plan"
        
        ir_plan_structure:
          
          section_1_overview:
            - "Purpose and scope of IR plan"
            - "Definitions (what constitutes an incident)"
            - "IR objectives and success criteria"
            
          section_2_team_and_roles:
            - "IR team members and contact information"
            - "Role descriptions and responsibilities"
            - "Escalation paths and decision authority"
            
          section_3_incident_classification:
            - "Severity levels (P1-P4) with definitions"
            - "Response SLAs per severity"
            - "Escalation requirements per severity"
            
          section_4_response_phases:
            - "Detection and analysis"
            - "Containment, eradication, recovery"
            - "Post-incident activities"
            
          section_5_communication:
            - "Internal communication procedures"
            - "External communication procedures (customers, media, regulators)"
            - "Communication templates"
            
          section_6_tools_and_resources:
            - "Forensic tools and access"
            - "External resources (legal, forensics, PR)"
            - "Log sources and data retention"
            
          section_7_legal_and_regulatory:
            - "Breach notification requirements by jurisdiction"
            - "Evidence preservation procedures"
            - "Legal consultation triggers"
            
        ir_plan_format:
          primary: "Comprehensive document (20-40 pages)"
          quick_reference: "One-page incident response card"
          digital: "Accessible wiki or portal"
          offline: "Printed copies for scenarios where network compromised"
          
      month_3_basic_playbooks:
        
        goal: "Document first 5 incident response playbooks"
        
        playbook_template:
          sections:
            - "Incident type and indicators"
            - "Immediate containment actions"
            - "Investigation steps"
            - "Eradication and recovery"
            - "Communication requirements"
            - "Evidence preservation"
            - "Post-incident actions"
            
        priority_playbooks:
          
          playbook_1_ransomware:
            trigger: "Files encrypted, ransom note detected"
            immediate_actions:
              - "Isolate infected systems from network"
              - "Identify patient zero and infection vector"
              - "Preserve forensic evidence"
              - "Assess backup availability"
            investigation:
              - "Identify ransomware family"
              - "Determine scope (how many systems)"
              - "Check for data exfiltration"
              - "Identify lateral movement paths"
            containment:
              - "Disable compromised accounts"
              - "Block command and control"
              - "Segment network to prevent spread"
            recovery:
              - "Restore from backups (if available)"
              - "Rebuild compromised systems"
              - "Verify eradication before reconnection"
              
          playbook_2_data_breach:
            trigger: "Unauthorized access to sensitive data detected"
            immediate_actions:
              - "Identify data accessed"
              - "Determine if exfiltration occurred"
              - "Preserve access logs and evidence"
              - "Assess legal notification requirements"
            investigation:
              - "Determine attack vector and timeline"
              - "Identify affected individuals/records"
              - "Assess attacker capabilities and motives"
            containment:
              - "Revoke attacker access"
              - "Patch or mitigate vulnerability"
              - "Monitor for persistence mechanisms"
            notification:
              - "Assess regulatory notification requirements"
              - "Coordinate with legal on customer notification"
              - "Prepare public statement if required"
              
          playbook_3_malware_infection:
            trigger: "Malware detected on endpoint or server"
            immediate_actions:
              - "Isolate infected system"
              - "Capture memory and disk forensics"
              - "Extract IOCs (hashes, IPs, domains)"
              - "Search for IOCs across environment"
            investigation:
              - "Determine malware family and capabilities"
              - "Identify infection vector"
              - "Assess if data was stolen"
              - "Check for additional compromised systems"
            eradication:
              - "Remove malware from infected systems"
              - "Block IOCs at network and endpoint"
              - "Patch vulnerability if exploited"
              
          playbook_4_compromised_credentials:
            trigger: "Account credential compromise suspected or confirmed"
            immediate_actions:
              - "Disable compromised account"
              - "Revoke active sessions"
              - "Force password reset"
              - "Review recent account activity"
            investigation:
              - "Determine compromise method (phishing, brute force, etc)"
              - "Identify data or systems accessed"
              - "Check for lateral movement"
              - "Assess if other accounts compromised"
            recovery:
              - "Re-enable account after security review"
              - "Implement MFA if not already enabled"
              - "Monitor account for 48 hours post-recovery"
              
          playbook_5_ddos_attack:
            trigger: "Service availability impacted by traffic flood"
            immediate_actions:
              - "Activate DDoS mitigation (Cloudflare, AWS Shield)"
              - "Contact ISP for upstream filtering"
              - "Assess attack vector and volume"
            mitigation:
              - "Enable rate limiting"
              - "Block attacking IPs/regions if feasible"
              - "Scale infrastructure if needed"
            communication:
              - "Status page updates for customers"
              - "Internal stakeholder updates"
              
    phase_2_capability_building:
      
      timeline: "Months 4-6"
      objective: "Build investigation capability and establish exercises"
      maturity_progression: "Level 1 optimization"
      
      month_4_forensic_capability:
        
        goal: "Establish digital forensics capability"
        
        forensic_tools:
          
          commercial_tools:
            encase: "Enterprise forensic investigation platform"
            ftk: "Forensic Toolkit for disk analysis"
            axiom: "Digital evidence management"
            cost: "$10K-$50K per license"
            
          open_source_tools:
            autopsy: "Disk image analysis"
            volatility: "Memory forensics"
            wireshark: "Network traffic analysis"
            sleuthkit: "File system analysis"
            cost: "Free, requires expertise"
            
          cloud_forensics:
            aws_forensics: "EC2 snapshot analysis, CloudTrail review"
            azure_forensics: "Disk snapshot, Activity Log analysis"
            gcp_forensics: "Persistent disk snapshot, Cloud Logging"
            
        forensic_procedures:
          
          memory_capture:
            when: "Before powering off system"
            tools: "Magnet RAM Capture, FTK Imager, WinPmem"
            why: "Capture running processes, network connections, encryption keys"
            
          disk_imaging:
            when: "Before remediation or reimaging"
            tools: "FTK Imager, dd, ewfcase"
            procedure:
              - "Write-protect source drive"
              - "Create bit-by-bit copy"
              - "Calculate and verify hashes"
              - "Document chain of custody"
            storage: "Retain images for 90 days minimum"
            
          log_collection:
            sources:
              - "System logs (Windows Event, syslog)"
              - "Application logs"
              - "Network logs (firewall, IDS, proxy)"
              - "Authentication logs"
            preservation: "Export before rotation period expires"
            
        forensic_workstation:
          hardware:
            - "High-performance workstation or server"
            - "Large storage capacity (multiple TB)"
            - "Write blockers for disk imaging"
          software:
            - "Forensic analysis tools"
            - "Virtualization for malware analysis"
            - "Network isolation for analyzing malicious artifacts"
          cost: "$5K-$15K per workstation"
          
      month_5_external_relationships:
        
        goal: "Establish relationships with external IR support"
        
        external_ir_retainer:
          purpose: "Expert assistance for major incidents beyond internal capability"
          vendors: "Mandiant, CrowdStrike Services, Dragos (ICS), Secureworks"
          retainer_model:
            - "Annual fee for guaranteed availability"
            - "Discounted hourly rates when engaged"
            - "Typical retainer: $25K-$100K annually"
          engagement_triggers:
            - "Advanced persistent threat (APT) suspected"
            - "Major ransomware affecting critical systems"
            - "Nation-state adversary suspected"
            - "Internal capability overwhelmed"
            
        legal_counsel:
          purpose: "Navigate breach notification, regulatory compliance, litigation"
          relationship:
            - "Establish relationship before incident"
            - "Understand firm's IR experience"
            - "Confirm availability and response time"
          attorney_client_privilege:
            - "Legal counsel engagement preserves privilege"
            - "Protects IR findings from discovery in litigation"
            - "Critical for sensitive investigations"
            
        cyber_insurance:
          coverage:
            - "Incident response costs"
            - "Forensics and legal fees"
            - "Business interruption"
            - "Ransom payment (if policy covers)"
            - "Regulatory fines and penalties"
          activation:
            - "Notify insurer within required timeframe (typically 24-48 hours)"
            - "Follow insurer's panel of approved vendors"
            - "Document all costs for reimbursement"
          cost: "$5K-$50K annually depending on coverage"
          
      month_6_first_tabletop_exercise:
        
        goal: "Conduct first IR tabletop exercise"
        
        tabletop_exercise_planning:
          
          scenario_selection:
            - "Choose realistic scenario relevant to organization"
            - "Start with moderate complexity (not worst case)"
            - "Example: Ransomware affecting subset of systems"
            
          participant_selection:
            required:
              - "IR team (all roles)"
              - "IT operations"
              - "Management (at least director level)"
            optional:
              - "Legal"
              - "PR/Communications"
              - "Business unit representatives"
              
          facilitator:
            options:
              - "Internal security leader"
              - "External consultant (recommended for first exercise)"
            responsibilities:
              - "Present scenario and injects"
              - "Facilitate discussion"
              - "Observe and document findings"
              
        exercise_execution:
          
          format:
            duration: "2-3 hours"
            location: "Conference room or virtual meeting"
            structure: "Scenario presentation → Team discussion → Injects → Debrief"
            
          scenario_progression:
            initial_state: "Friday 5 PM: Users report encrypted files, ransom note"
            inject_1: "Infection spreading to additional systems"
            inject_2: "Backups also encrypted"
            inject_3: "Attacker threatens to leak data publicly"
            inject_4: "Media inquiries about breach"
            
          discussion_prompts:
            - "Who needs to be notified immediately?"
            - "What are the first containment actions?"
            - "How do we determine scope of compromise?"
            - "Do we engage external IR firm?"
            - "Do we pay ransom? Who decides?"
            - "What do we tell customers?"
            
        post_exercise_activities:
          
          hot_debrief:
            timing: "Immediately after exercise"
            discussion:
              - "What went well?"
              - "What was confusing?"
              - "What gaps did we identify?"
              
          formal_report:
            timing: "Within 1 week"
            contents:
              - "Exercise scenario and participants"
              - "Observed strengths"
              - "Identified gaps and weaknesses"
              - "Recommendations for improvement"
              - "Action items with owners and due dates"
              
          remediation_tracking:
            - "Assign gap remediation to owners"
            - "Track progress monthly"
            - "Verify completion before next exercise"
            
    phase_3_operational_maturity:
      
      timeline: "Months 7-9"
      objective: "Expand playbook coverage and improve response speed"
      maturity_progression: "Level 1 → Level 2"
      
      month_7_expanded_playbooks:
        
        goal: "Document 5 additional playbooks (total 10)"
        
        additional_playbooks:
          
          insider_threat:
            indicators:
              - "Unusual data access patterns"
              - "Large data downloads or uploads"
              - "After-hours access to sensitive systems"
              - "Attempts to bypass security controls"
            investigation:
              - "Review user's access history"
              - "Interview manager about recent behavior changes"
              - "Analyze data accessed and exfiltrated"
              - "Coordinate with HR and legal"
            containment:
              - "Disable user account"
              - "Collect evidence while user unaware (if legal allows)"
              - "Prepare for potential termination"
              
          supply_chain_compromise:
            indicators:
              - "Malicious update from trusted vendor"
              - "Compromised third-party tool or library"
            investigation:
              - "Identify affected systems using compromised component"
              - "Determine compromise timeline"
              - "Contact vendor for details"
              - "Search for IOCs across environment"
            containment:
              - "Isolate systems using compromised component"
              - "Block malicious infrastructure"
              - "Await vendor guidance on remediation"
              
          cloud_account_compromise:
            indicators:
              - "Unusual API calls or resource creation"
              - "Access from unexpected locations"
              - "Privilege escalation in cloud environment"
            investigation:
              - "Review CloudTrail/Activity Logs"
              - "Identify compromised credentials"
              - "Assess resources accessed or modified"
              - "Check for persistence mechanisms (backdoor users, keys)"
            containment:
              - "Rotate compromised credentials"
              - "Delete unauthorized resources"
              - "Review and remove backdoor access"
              
          website_defacement:
            indicators:
              - "Unauthorized changes to website content"
              - "Malicious code injected into web pages"
            investigation:
              - "Identify compromise method (SQL injection, vulnerable plugin, stolen credentials)"
              - "Review web server and application logs"
              - "Check for web shell or backdoor"
            containment:
              - "Take site offline if actively serving malware"
              - "Restore from clean backup"
              - "Patch vulnerability"
              - "Reset all CMS and database credentials"
              
          business_email_compromise:
            indicators:
              - "Executive or finance email account compromised"
              - "Fraudulent wire transfer requests"
              - "Email forwarding rules created"
            investigation:
              - "Review account activity and login history"
              - "Check for email forwarding or filters"
              - "Identify any fraudulent emails sent"
              - "Assess financial impact"
            containment:
              - "Disable compromised account"
              - "Alert finance to halt any pending transfers"
              - "Remove forwarding rules"
              - "Notify contacts who received malicious emails"
              
      month_8_detection_integration:
        
        goal: "Integrate detection and response workflows"
        
        siem_to_ir_workflow:
          automated_alert_enrichment:
            - "Extract indicators from SIEM alert"
            - "Enrich with threat intelligence"
            - "Add user and asset context"
            - "Populate incident ticket automatically"
          analyst_handoff:
            - "Enriched alert presented to analyst"
            - "Analyst reviews and makes containment decision"
            - "One-click containment actions from SIEM"
            
        edr_to_ir_workflow:
          automated_containment:
            - "EDR detects malware"
            - "EDR automatically isolates endpoint"
            - "EDR alerts IR team"
            - "IR team investigates and remediates"
          forensic_collection:
            - "EDR captures forensic artifacts automatically"
            - "Memory dump, disk image, process tree"
            - "Artifacts available to IR team immediately"
            
        cross_reference: "See Chapter 2.4 Detection Engineering and 4.1 Automation for detailed integration patterns"
        
      month_9_metrics_and_optimization:
        
        goal: "Establish IR metrics and optimize based on data"
        
        key_metrics:
          
          mean_time_to_detect:
            definition: "Time from compromise to detection"
            calculation: "Detection timestamp - Initial compromise timestamp"
            target: "Level 1: <7 days, Level 2: <24 hours, Level 3: <4 hours"
            improvement_drivers:
              - "Better detection rules"
              - "Threat intelligence integration"
              - "Proactive threat hunting"
              
          mean_time_to_respond:
            definition: "Time from detection to response action started"
            calculation: "First response action - Detection timestamp"
            target: "Level 1: <24 hours, Level 2: <4 hours, Level 3: <1 hour"
            improvement_drivers:
              - "Clear playbooks"
              - "Automated enrichment"
              - "Practiced procedures"
              
          mean_time_to_contain:
            definition: "Time from detection to containment complete"
            calculation: "Containment timestamp - Detection timestamp"
            target: "Level 1: <1 week, Level 2: <24 hours, Level 3: <4 hours"
            improvement_drivers:
              - "Rapid decision-making"
              - "Automated containment"
              - "Clear authority to act"
              
          mean_time_to_recover:
            definition: "Time from detection to full recovery"
            calculation: "Recovery timestamp - Detection timestamp"
            target: "Level 1: <1 month, Level 2: <1 week, Level 3: <48 hours"
            improvement_drivers:
              - "Good backups"
              - "Automated recovery procedures"
              - "Thorough eradication"




phase_4_continuous_improvement:
      
      timeline: "Months 10-12"
      objective: "Establish continuous improvement culture and advanced capabilities"
      maturity_progression: "Level 2 preparation"
      
      month_10_threat_intelligence_integration:
        
        goal: "Integrate threat intelligence into IR workflows"
        
        threat_intel_sources:
          
          strategic_intelligence:
            sources: "Vendor reports, industry briefings, government bulletins"
            use_in_ir: "Understand adversary tactics and campaigns targeting industry"
            application:
              - "Scenario planning for tabletop exercises"
              - "Playbook development for emerging threats"
              - "Executive briefings on threat landscape"
              
          tactical_intelligence:
            sources: "TTPs, attack patterns, malware analysis reports"
            use_in_ir: "Guide investigation and understand attacker behavior"
            application:
              - "During investigation: Match observed behavior to known adversaries"
              - "Predict next steps in attack progression"
              - "Identify similar historical campaigns"
              
          operational_intelligence:
            sources: "IOCs (IPs, domains, hashes), YARA rules"
            use_in_ir: "Hunt for compromise indicators, block malicious infrastructure"
            application:
              - "Automated enrichment during investigation"
              - "Proactive hunting with fresh IOCs"
              - "Blocking at perimeter and endpoints"
              
        intel_platform_integration:
          threat_intel_platform: "MISP, ThreatConnect, Anomali"
          integration_points:
            - "SIEM receives IOC feeds for detection"
            - "IR playbooks query TIP during investigation"
            - "EDR receives IOC feeds for blocking"
            - "Firewall receives IP/domain feeds"
          feedback_loop:
            - "IR team contributes IOCs from investigations back to TIP"
            - "Sharing with industry peers (anonymized)"
            
      month_11_advanced_forensics:
        
        goal: "Develop advanced forensic capabilities"
        
        malware_analysis:
          
          static_analysis:
            techniques:
              - "File hash and signature analysis"
              - "Strings extraction"
              - "PE header analysis"
              - "Disassembly (IDA Pro, Ghidra)"
            capabilities:
              - "Identify malware family"
              - "Extract IOCs"
              - "Understand basic functionality"
              
          dynamic_analysis:
            environment: "Isolated sandbox (Cuckoo, ANY.RUN, Joe Sandbox)"
            techniques:
              - "Execute malware in controlled environment"
              - "Monitor process activity, registry, filesystem"
              - "Capture network traffic"
              - "Observe malware behavior"
            capabilities:
              - "Identify C2 infrastructure"
              - "Understand persistence mechanisms"
              - "Extract additional IOCs"
              
          reverse_engineering:
            tools: "IDA Pro, Ghidra, x64dbg"
            techniques:
              - "Disassembly and decompilation"
              - "Control flow analysis"
              - "Algorithm identification"
            capabilities:
              - "Deep understanding of malware functionality"
              - "Identify zero-day exploits"
              - "Develop detection signatures"
            skill_level: "Advanced - requires specialized training"
            
        cloud_forensics:
          
          aws_forensics:
            evidence_sources:
              - "CloudTrail logs (API activity)"
              - "VPC Flow Logs (network traffic)"
              - "EBS snapshots (disk images)"
              - "Memory dumps from EC2"
            tools:
              - "AWS native: CloudTrail, Detective, GuardDuty"
              - "Third-party: Prowler, ScoutSuite"
            procedures:
              - "Snapshot compromised instances"
              - "Preserve logs before retention expires"
              - "Analyze CloudTrail for unauthorized actions"
              
          azure_forensics:
            evidence_sources:
              - "Activity Log (subscription-level events)"
              - "NSG Flow Logs (network traffic)"
              - "Disk snapshots"
              - "Azure Monitor logs"
            procedures:
              - "Snapshot VM disks"
              - "Export Activity Logs"
              - "Analyze sign-in logs for compromise"
              
          container_forensics:
            challenges:
              - "Ephemeral nature (containers deleted)"
              - "Limited logging by default"
              - "Shared kernel (less isolation than VMs)"
            evidence_sources:
              - "Container logs"
              - "Kubernetes audit logs"
              - "Image analysis (Docker layers)"
            procedures:
              - "Preserve container images before deletion"
              - "Analyze image layers for malicious code"
              - "Review orchestrator logs (Kubernetes, ECS)"
              
      month_12_program_assessment:
        
        goal: "Assess IR program maturity and plan next year"
        
        comprehensive_assessment:
          
          capability_review:
            questions:
              - "Can we detect common attack patterns?"
              - "Can we respond within SLA targets?"
              - "Do playbooks cover major scenarios?"
              - "Is team trained and practiced?"
              - "Are metrics showing improvement?"
              
          gap_analysis:
            - "Scenarios without playbooks"
            - "Detection blind spots"
            - "Tool or skill deficiencies"
            - "Process bottlenecks"
            
          stakeholder_feedback:
            - "Survey IR team on program effectiveness"
            - "Interview executives on confidence in IR"
            - "Review incident participant feedback"
            
        year_2_planning:
          
          advanced_capabilities:
            - "Automated response for common incidents"
            - "Proactive threat hunting program"
            - "Red team exercises"
            - "Industry threat intelligence sharing"
            
          team_development:
            - "Advanced forensics training"
            - "Malware analysis certification"
            - "Cloud security specialization"
            - "Threat intelligence analysis"
            
          tool_enhancements:
            - "SOAR platform for orchestration"
            - "Advanced EDR capabilities"
            - "Threat intelligence platform"
            - "Cloud forensic tools"
            
  ir_framework_and_methodology:
    
    audience: "Level 1+ organizations establishing systematic IR approach"
    
    overview: |
      IR frameworks provide systematic approach to incident handling. This section 
      addresses industry-standard frameworks (NIST, SANS), phase-by-phase methodology, 
      and decision frameworks for complex scenarios.
      
    nist_incident_response_lifecycle:
      
      overview: "NIST SP 800-61: Computer Security Incident Handling Guide"
      
      phase_1_preparation:
        objective: "Establish capability and readiness before incidents"
        activities:
          - "Develop and document IR policies and procedures"
          - "Establish IR team with defined roles"
          - "Acquire tools and resources"
          - "Establish communication channels"
          - "Conduct training and exercises"
        success_metrics:
          - "IR plan documented and accessible"
          - "Team trained and equipped"
          - "Exercises conducted regularly"
        
      phase_2_detection_and_analysis:
        objective: "Identify security incidents and determine scope"
        activities:
          indicators_of_compromise:
            - "SIEM alerts and correlation"
            - "EDR detections"
            - "User reports of suspicious activity"
            - "Threat intelligence matches"
          initial_analysis:
            - "Validate alert is true positive"
            - "Determine incident type and severity"
            - "Identify affected systems and data"
            - "Begin evidence collection"
          documentation:
            - "Create incident ticket"
            - "Document timeline"
            - "Preserve initial evidence"
        success_metrics:
          - "Mean time to detect <24 hours (Level 1), <4 hours (Level 2)"
          - "False positive rate <20%"
          - "Complete initial assessment within 1 hour"
          
      phase_3_containment_eradication_recovery:
        
        containment:
          objective: "Limit damage and prevent further compromise"
          short_term_containment:
            - "Isolate affected systems"
            - "Disable compromised accounts"
            - "Block malicious infrastructure"
            - "Stop active data exfiltration"
          long_term_containment:
            - "Apply temporary fixes"
            - "Deploy additional monitoring"
            - "Prepare for recovery"
          considerations:
            - "Balance containment speed vs evidence preservation"
            - "Consider business impact of containment actions"
            - "Document all containment actions"
            
        eradication:
          objective: "Remove threat from environment"
          activities:
            - "Delete malware and malicious artifacts"
            - "Remove attacker persistence mechanisms"
            - "Patch exploited vulnerabilities"
            - "Reset compromised credentials"
          validation:
            - "Scan for remaining threats"
            - "Verify attacker access revoked"
            - "Test that vulnerability patched"
            
        recovery:
          objective: "Restore systems to normal operation"
          activities:
            - "Restore from clean backups"
            - "Rebuild compromised systems"
            - "Restore services incrementally"
            - "Monitor for reinfection"
          verification:
            - "Confirm system integrity"
            - "Verify business functionality"
            - "Increased monitoring for 48-72 hours"
            
      phase_4_post_incident_activity:
        objective: "Learn from incident and improve defenses"
        activities:
          - "Conduct post-incident review meeting"
          - "Document lessons learned"
          - "Identify improvement opportunities"
          - "Update playbooks and procedures"
          - "Track remediation completion"
        success_metrics:
          - "Post-incident review completed within 1 week"
          - "Action items tracked to completion"
          - "Similar incidents prevented"
          
    sans_incident_response_process:
      
      overview: "SANS Institute Six-Step Incident Response Process"
      
      steps:
        step_1_preparation:
          activities: "Same as NIST Preparation"
          
        step_2_identification:
          activities: "Detect and validate incident"
          focus: "Reduce false positives, rapid triage"
          
        step_3_containment:
          activities: "Stop damage progression"
          focus: "Speed and minimizing business impact"
          
        step_4_eradication:
          activities: "Remove threat completely"
          focus: "Thorough removal, prevent reinfection"
          
        step_5_recovery:
          activities: "Restore normal operations"
          focus: "Verify clean, monitor for issues"
          
        step_6_lessons_learned:
          activities: "Review and improve"
          focus: "Continuous improvement culture"
          
    decision_frameworks:
      
      to_pay_or_not_ransomware:
        
        factors_against_paying:
          - "No guarantee of data recovery"
          - "Funds support criminal enterprise"
          - "May violate sanctions (OFAC)"
          - "Encourages future attacks"
          - "Reputational risk"
          
        factors_for_paying:
          - "No viable backups"
          - "Critical business operations down"
          - "Recovery time exceeds business tolerance"
          - "Data exfiltration threatened"
          
        decision_process:
          step_1: "Assess backup availability and recovery time"
          step_2: "Calculate business impact of downtime"
          step_3: "Consult legal (sanctions, reporting)"
          step_4: "Consult cyber insurance"
          step_5: "Executive decision with full context"
          
        recommendation: "Default to not paying, pay only as last resort"
        
      public_disclosure_timing:
        
        factors_for_immediate_disclosure:
          - "Customer data compromised requiring notification"
          - "Public disclosure legally required"
          - "Media already aware"
          - "Transparency benefits brand"
          
        factors_for_delayed_disclosure:
          - "Investigation incomplete"
          - "Premature disclosure alerts attacker"
          - "Regulatory notification windows allow delay"
          - "Need time to prepare customer support"
          
        decision_framework:
          legal_requirements: "Consult legal on notification timelines"
          business_impact: "Assess customer and brand impact"
          investigation_needs: "Balance with investigation requirements"
          
      law_enforcement_engagement:
        
        factors_for_engagement:
          - "Nation-state adversary"
          - "Critical infrastructure targeting"
          - "Ransom payment consideration (FBI wants to know)"
          - "Broader threat to industry"
          
        factors_against_engagement:
          - "Concerns about investigation delays"
          - "Publicity risks"
          - "Limited law enforcement resources for lower-tier incidents"
          
        when_to_engage:
          immediate: "Active threat to life, critical infrastructure"
          early: "Major ransomware, nation-state, significant theft"
          after_containment: "Lower-severity incidents"
          
  incident_classification:
    
    audience: "All levels - consistent incident categorization"
    
    overview: |
      Incident classification determines response urgency, escalation requirements, 
      and resource allocation. Consistent classification enables appropriate response 
      and meaningful metrics. This section addresses severity levels, impact assessment, 
      and classification decision trees.
      
    severity_levels:
      
      p1_critical:
        definition: "Immediate threat to business operations or catastrophic data breach"
        examples:
          - "Active ransomware encrypting production systems"
          - "Mass data exfiltration in progress"
          - "Critical infrastructure compromise"
          - "Public-facing breach (website defacement serving malware)"
        response_sla: "Immediate response (<15 minutes)"
        escalation: "Incident commander, CISO, executive team"
        communication: "Hourly updates to executives"
        resources: "All hands on deck, external IR if needed"
        
      p2_high:
        definition: "Significant security compromise requiring rapid response"
        examples:
          - "Confirmed malware on multiple systems"
          - "Compromised privileged account"
          - "Data breach affecting <10K records"
          - "Successful phishing with credential theft"
        response_sla: "Response within 1 hour"
        escalation: "Incident commander, security management"
        communication: "Twice-daily updates to management"
        resources: "Core IR team, may engage external support"
        
      p3_medium:
        definition: "Security incident requiring investigation but no immediate threat"
        examples:
          - "Single system malware infection"
          - "Non-privileged account compromise"
          - "Scanning or probing activity"
          - "Policy violation with security implications"
        response_sla: "Response within 4 hours"
        escalation: "IR team lead"
        communication: "Daily updates if incident extends beyond 24 hours"
        resources: "On-call responder, escalate if needed"
        
      p4_low:
        definition: "Security event requiring monitoring but minimal response"
        examples:
          - "False positive security alert requiring documentation"
          - "Unsuccessful attack attempts"
          - "Minor policy violations"
          - "Security information requests"
        response_sla: "Response within 24 hours"
        escalation: "None required"
        communication: "Documented in ticket, no active updates"
        resources: "Handle during normal business hours"
        
    impact_assessment_framework:
      
      dimensions_of_impact:
        
        confidentiality_impact:
          none: "No data accessed or exfiltrated"
          low: "Non-sensitive data accessed"
          medium: "Sensitive data accessed but not exfiltrated"
          high: "Sensitive data exfiltrated, <10K records"
          critical: "Massive data exfiltration, >10K records or highly sensitive data"
          
        integrity_impact:
          none: "No data or systems modified"
          low: "Non-critical systems or data modified"
          medium: "Business-critical systems modified, integrity questionable"
          high: "Financial or operational data modified"
          critical: "Widespread data corruption or destruction"
          
        availability_impact:
          none: "No service disruption"
          low: "Non-critical service degradation"
          medium: "Critical service degraded, business continues"
          high: "Critical service down, significant business impact"
          critical: "Complete service outage, business halted"
          
        business_impact:
          financial: "Revenue loss, recovery costs, fines"
          operational: "Productivity loss, service disruption"
          reputational: "Customer trust, brand damage, media coverage"
          regulatory: "Notification requirements, fines, sanctions"
          
      classification_decision_tree:
        question_1: "Is business-critical service currently down?"
        if_yes: "P1 Critical"
        if_no: "Continue to question 2"
        
        question_2: "Is active data exfiltration or encryption occurring?"
        if_yes: "P1 Critical"
        if_no: "Continue to question 3"
        
        question_3: "Are multiple systems compromised or is privileged account compromised?"
        if_yes: "P2 High"
        if_no: "Continue to question 4"
        
        question_4: "Is single system compromised or data accessed without exfiltration?"
        if_yes: "P3 Medium"
        if_no: "P4 Low"
        
  playbook_development:
    
    audience: "Level 1+ organizations documenting response procedures"
    
    overview: |
      Playbooks codify institutional knowledge and enable consistent response. This 
      section addresses advanced playbook development, cloud-specific scenarios, and 
      emerging threat response patterns.
      
    advanced_playbook_scenarios:
      
      advanced_persistent_threat:
        
        characteristics:
          - "Sophisticated adversary with clear objective"
          - "Long-term presence in environment (weeks to months)"
          - "Custom malware and tools"
          - "Focus on data theft and espionage"
          
        detection_indicators:
          - "Unusual lateral movement patterns"
          - "Data staging and exfiltration over extended period"
          - "Living-off-the-land techniques (using legitimate tools)"
          - "Multiple persistence mechanisms"
          
        response_approach:
          intelligence_gathering:
            - "Do NOT immediately contain (alerts adversary)"
            - "Monitor and document adversary activity"
            - "Identify adversary objectives and TTPs"
            - "Map compromised systems and accounts"
            duration: "1-7 days of observation"
            
          coordinated_remediation:
            - "Plan coordinated remediation across all compromised systems"
            - "Execute remediation simultaneously (prevent adversary pivot)"
            - "Rotate all credentials"
            - "Deploy enhanced monitoring"
            timing: "Execute during planned window"
            
          post_remediation:
            - "Monitor for adversary return attempts"
            - "Threat hunt for additional compromise"
            - "Update defenses based on observed TTPs"
            - "Consider attribution and threat intelligence sharing"
            
        external_support: "Strongly recommend engaging external IR firm with APT expertise"
        
      zero_day_exploitation:
        
        scenario: "Active exploitation of unknown vulnerability"
        
        immediate_actions:
          - "Identify affected systems and applications"
          - "Isolate affected systems if feasible"
          - "Capture network traffic and system artifacts"
          - "Contact vendor for emergency patch"
          
        investigation:
          - "Reverse engineer exploit if possible"
          - "Identify indicators of exploitation"
          - "Search for exploitation across environment"
          - "Assess if vulnerability weaponized or targeted"
          
        mitigation_without_patch:
          - "Deploy WAF rules if web vulnerability"
          - "Block exploit signatures at IDS/IPS"
          - "Disable vulnerable feature if possible"
          - "Network segmentation to limit exploitation"
          
        long_term_response:
          - "Apply patch immediately when available"
          - "Develop detection for exploitation attempts"
          - "Assess if vulnerability in other products"
          - "Consider contributing to CVE process"
          
      supply_chain_attack:
        
        scenario: "Trusted software or vendor compromised, affecting customers"
        
        discovery_methods:
          - "Vendor notification of compromise"
          - "Detection of unusual behavior from trusted software"
          - "Threat intelligence reporting campaign"
          
        assessment_phase:
          - "Identify all systems using compromised vendor/software"
          - "Determine timeline of compromise"
          - "Assess if malicious code executed in environment"
          - "Contact vendor for details and guidance"
          
        containment:
          - "Isolate systems running compromised software"
          - "Block C2 infrastructure if identified"
          - "Disable compromised software update mechanism"
          - "Deploy compensating controls"
          
        recovery:
          - "Await vendor guidance on clean version"
          - "Verify clean version before deployment"
          - "Consider alternative vendors if breach severe"
          - "Enhanced monitoring of supply chain going forward"
          
        communication:
          - "Inform customers if you are the compromised vendor"
          - "Coordinate with other affected organizations"
          - "Share IOCs and TTPs with community"
          
      cloud_cryptojacking:
        
        scenario: "Unauthorized cryptocurrency mining in cloud environment"
        
        indicators:
          - "Unexpected increase in compute costs"
          - "High CPU utilization on instances"
          - "Unusual process execution"
          - "Connections to mining pools"
          
        investigation:
          - "Review CloudTrail/Activity Logs for unauthorized resource creation"
          - "Identify compromised credentials or vulnerable services"
          - "Assess scale of unauthorized resource usage"
          - "Calculate financial impact"
          
        containment:
          - "Terminate unauthorized instances"
          - "Rotate compromised credentials"
          - "Patch or disable exploited service"
          - "Implement resource limits and alerts"
          
        prevention:
          - "Restrict instance types that can be launched"
          - "Alert on unusual resource provisioning"
          - "Regular cloud security posture assessment"
          - "Principle of least privilege for cloud IAM"
          
      kubernetes_container_breakout:
        
        scenario: "Attacker escapes container, accesses underlying host or cluster"
        
        indicators:
          - "Container attempting to access host filesystem"
          - "Unusual syscalls or privileged operations"
          - "Container accessing Kubernetes API without authorization"
          - "Lateral movement between containers/nodes"
          
        investigation:
          - "Review container runtime logs"
          - "Analyze Kubernetes audit logs"
          - "Identify compromised container and vulnerability"
          - "Assess blast radius (what was accessed)"
          
        containment:
          - "Delete compromised pods"
          - "Isolate affected nodes"
          - "Rotate service account tokens"
          - "Deploy network policies to prevent lateral movement"
          
        remediation:
          - "Patch container escape vulnerability"
          - "Implement pod security policies/standards"
          - "Remove unnecessary container privileges"
          - "Deploy runtime security monitoring"
          
  investigation_and_forensics:
    
    audience: "Level 2+ organizations conducting technical investigations"
    
    overview: |
      Forensic investigation determines what happened, when, how, and by whom. This 
      section addresses systematic investigation methodology, evidence collection, 
      timeline reconstruction, and root cause analysis.
      
    investigation_methodology:
      
      evidence_collection:
        
        volatile_evidence:
          priority: "Collect first - lost when system powered off"
          sources:
            - "Running processes and services"
            - "Network connections and routing tables"
            - "Logged-in users and sessions"
            - "Clipboard contents"
            - "RAM contents (memory dump)"
          tools: "FTK Imager, Magnet RAM Capture, WinPmem"
          timing: "Collect before any containment actions that power off system"
          
        non_volatile_evidence:
          priority: "Collect after volatile evidence"
          sources:
            - "Disk images (full forensic copy)"
            - "File system metadata"
            - "Registry (Windows)"
            - "Log files"
            - "Browser history and artifacts"
          tools: "FTK Imager, dd, ewfacquire"
          timing: "Before system remediation or reimaging"
          
        network_evidence:
          sources:
            - "Firewall logs"
            - "IDS/IPS logs"
            - "Proxy logs"
            - "PCAP files"
            - "NetFlow records"
          collection: "Preserve before log rotation"
          
        cloud_evidence:
          sources:
            - "CloudTrail, Activity Logs, Cloud Audit Logs"
            - "VPC Flow Logs, NSG Flow Logs"
            - "Instance snapshots"
            - "Container logs"
          collection: "Export immediately - retention policies may delete"
          
        chain_of_custody:
          requirements:
            - "Document who collected evidence"
            - "Document when and where collected"
            - "Document handling and transfer"
            - "Maintain evidence integrity (hashes)"
          purpose: "Admissible in legal proceedings"
          
      timeline_reconstruction:
        
        objective: "Build chronological view of attacker actions"
        
        timeline_components:
          initial_access:
            - "How did attacker gain first foothold?"
            - "When did initial compromise occur?"
            - "What vulnerability or vector was exploited?"
            
          privilege_escalation:
            - "How did attacker gain elevated privileges?"
            - "What accounts were compromised?"
            - "What privilege escalation techniques used?"
            
          lateral_movement:
            - "What systems did attacker access?"
            - "What paths did attacker use to move?"
            - "Timeline of system-to-system movement"
            
          data_access:
            - "What data did attacker access?"
            - "When was data accessed?"
            - "Was data exfiltrated?"
            
          persistence:
            - "What persistence mechanisms deployed?"
            - "When were backdoors created?"
            - "How would attacker regain access?"
            
        timeline_tools:
          plaso: "log2timeline - automated timeline generation"
          timesketch: "Timeline analysis and collaboration"
          splunk: "Timeline visualization from SIEM data"
          manual: "Spreadsheet timeline for smaller investigations"
          
        correlation_techniques:
          - "Align timestamps across systems (account for time zones)"
          - "Correlate events across multiple log sources"
          - "Identify gaps in timeline (anti-forensics?)"
          - "Validate timeline with network evidence"
          
      root_cause_analysis:
        
        five_whys_technique:
          example:
            incident: "Ransomware encrypted 500 servers"
            why_1: "Why did ransomware spread? → Attacker had domain admin credentials"
            why_2: "Why did attacker have domain admin? → Credentials stolen from IT admin workstation"
            why_3: "Why were credentials on workstation? → Admin used personal credentials to manage servers"
            why_4: "Why was admin using personal credentials? → Privileged access management not deployed"
            why_5: "Why was PAM not deployed? → Not prioritized in security roadmap"
            root_cause: "Lack of privileged access management enabled credential theft"
            
        fishbone_diagram:
          categories:
            people: "Training gaps, policy violations, malicious insiders"
            process: "Inadequate procedures, missing controls, poor coordination"
            technology: "Unpatched vulnerabilities, misconfigured systems, detection gaps"
            external: "Sophisticated adversary, zero-day exploit, supply chain compromise"
          analysis: "Identify contributing factors in each category"
          
        corrective_actions:
          immediate: "Stop ongoing impact"
          short_term: "Address root cause (patch, deploy control)"
          long_term: "Prevent recurrence (process improvement, training)"
          
  containment_strategies:
    
    audience: "Level 1+ organizations executing containment"
    
    overview: |
      Containment limits damage and prevents attacker objective achievement. This 
      section addresses containment decision-making, techniques by threat type, and 
      balancing containment speed with business continuity.
      
    containment_decision_framework:
      
      factors_to_consider:
        
        business_impact:
          question: "What is cost of containment action vs cost of continued compromise?"
          examples:
            low_impact: "Isolate single non-critical workstation → Minimal business impact"
            high_impact: "Shut down production database → Significant business impact"
          approach: "Choose least disruptive containment that stops attack"
          
        evidence_preservation:
          question: "Does containment destroy forensic evidence?"
          examples:
            preserves: "Network isolation maintains system state"
            destroys: "Powering off loses memory contents"
          approach: "Collect evidence before destructive containment"
          
        adversary_awareness:
          question: "Will containment alert adversary to detection?"
          examples:
            overt: "Disabling account alerts adversary immediately"
            covert: "Passive monitoring doesn't alert adversary"
          approach: "For APT, consider monitoring before containment. For ransomware, contain immediately"
          
        reinfection_risk:
          question: "Will adversary regain access after containment?"
          examples:
            high_risk: "Containing without removing persistence mechanisms"
            low_risk: "Simultaneous containment and eradication"
          approach: "Ensure thorough eradication before recovery"
          
    containment_techniques_by_threat:
      
      malware_containment:
        network_isolation:
          - "Disconnect from network (physical or VLAN isolation)"
          - "Prevents C2 communication and lateral spread"
          - "Maintains system state for forensics"
        process_termination:
          - "Kill malicious process"
          - "Rapid but doesn't prevent restart if persistence exists"
        file_quarantine:
          - "Move malicious files to quarantine location"
          - "Prevents execution while preserving for analysis"
        endpoint_isolation:
          - "EDR-based network isolation (remote command)"
          - "Allows continued forensic collection while isolated"
          
      account_compromise_containment:
        immediate_actions:
          - "Disable compromised account"
          - "Revoke all active sessions and tokens"
          - "Reset password"
        investigation_actions:
          - "Review account activity during compromise period"
          - "Identify data or systems accessed"
          - "Check for persistence (API keys, SSH keys, backdoor accounts)"
        recovery:
          - "Force MFA re-enrollment"
          - "Monitor account for 48 hours post-recovery"
          
      ransomware_containment:
        speed_critical: "Every minute allows more encryption"
        actions:
          - "Immediately isolate infected systems (do not wait for investigation)"
          - "Disable compromised accounts used for lateral movement"
          - "Shut down non-critical systems to prevent spread"
          - "Block C2 domains and IPs if identified"
        considerations:
          - "Balance containment speed with evidence collection"
          - "Prioritize stopping spread over forensics"
          - "Accept some forensic data loss in service of speed"
          
      data_breach_containment:
        stop_exfiltration:
          - "Block outbound connections to attacker infrastructure"
          - "Rate-limit or block compromised account data access"
          - "Disable bulk export capabilities if available"
        access_revocation:
          - "Revoke attacker access to data repositories"
          - "Change database credentials"
          - "Disable vulnerable applications"
        monitoring:
          - "Enhanced logging and alerting on data access"
          - "Monitor for re-compromise attempts"
          
  communication_and_escalation:
    
    audience: "All levels - stakeholder management during incidents"
    
    overview: |
      Effective communication prevents panic, enables coordination, and maintains trust. 
      This section addresses communication strategies for different stakeholders, 
      escalation procedures, and regulatory notification requirements.
      
    internal_communication:
      
      ir_team_communication:
        war_room:
          purpose: "Central coordination point during incident"
          format:
            physical: "Conference room with displays, phones, workstations"
            virtual: "Video conference + shared chat (Slack, Teams)"
          participants: "IR team, IT operations, relevant SMEs"
          duration: "Entire incident response period"
          
        communication_cadence:
          active_incident: "Continuous communication in war room"
          updates: "Hourly status updates to management"
          shift_handoffs: "Detailed handoff documentation between shifts"
          
      management_communication:
        executive_briefs:
          frequency: "Hourly for P1, twice daily for P2, daily for P3"
          format: "Email or Slack with consistent structure"
          content:
            - "Current status (one sentence)"
            - "Business impact"
            - "Actions taken"
            - "Next steps and timeline"
            - "Assistance needed"
          tone: "Concise, factual, no technical jargon"
          
        escalation_triggers:
          immediate_escalation:
            - "P1 critical incident"
            - "Potential data breach requiring notification"
            - "Significant business operations impact"
            - "Media inquiry or public awareness"
          scheduled_escalation:
            - "Daily briefing for extended incidents"
            - "Major decisions (ransom payment, system shutdown)"
            
      employee_communication:
        when_to_communicate:
          - "If employees directly impacted (systems down, password resets required)"
          - "If public disclosure made"
          - "If employee action required (phishing awareness)"
        messaging:
          - "What happened (high level, no sensitive details)"
          - "What employees should do"
          - "Who to contact with questions"
          - "Expected timeline for resolution"
          
    external_communication:
      
      customer_communication:
        notification_requirements:
          - "Data breach affecting customer data"
          - "Service disruption impacting customers"
          - "Security incident requiring customer action (password reset)"
        timing:
          - "As soon as facts established (don't delay unnecessarily)"
          - "Balance speed with accuracy (don't communicate speculation)"
        channels:
          - "Email to affected customers"
          - "Public statement on website"
          - "Social media updates"
          - "Status page for service disruptions"
        content:
          - "What happened and when"
          - "What data was involved"
          - "What organization is doing"
          - "What customers should do"
          - "Who to contact for questions"
        tone: "Transparent, empathetic, actionable"
        
      regulatory_notification:
        
        gdpr_requirements:
          jurisdiction: "European Union, UK"
          trigger: "Personal data breach"
          timeline:
            authority: "72 hours to data protection authority"
            individuals: "Without undue delay if high risk"
          content:
            - "Nature of breach and data involved"
            - "Number of affected individuals"
            - "Consequences and remediation"
            - "Contact information for inquiries"
          penalties: "Up to €20M or 4% revenue"
          
        us_state_breach_laws:
          jurisdiction: "All 50 US states have laws (specifics vary)"
          trigger: "Personal information breach (SSN, financial, health)"
          timeline: "Varies by state (typically 'expeditiously', some specify days)"
          requirements:
            california: "Attorney General if >500 residents"
            massachusetts: "Attorney General, Director of Consumer Affairs"
            others: "Check state-specific requirements"
            
        sector_specific:
          hipaa: "Healthcare - 60 days for breaches affecting >500 individuals"
          glba: "Financial services - notify customers as soon as possible"
          pci_dss: "Payment cards - notify card brands and acquirer immediately"
          
      media_relations:
        when_media_involved:
          - "Public-facing incident (website defacement, service outage)"
          - "Data breach affecting significant number of people"
          - "High-profile victim organization"
        spokesperson:
          - "Designated spokesperson (CEO, CISO, PR lead)"
          - "Media training recommended"
          - "Consistent messaging across all interviews"
        message_discipline:
          do:
            - "Acknowledge incident factually"
            - "Express commitment to customers and security"
            - "Explain actions being taken"
          dont:
            - "Speculate on details not yet confirmed"
            - "Blame individuals or teams"
            - "Provide overly technical details"
            - "Say 'no comment' (looks defensive)"
            
      law_enforcement_coordination:
        when_to_engage:
          - "Nation-state or APT activity"
          - "Ransomware incident"
          - "Significant financial fraud"
          - "Child exploitation material discovered"
        who_to_contact:
          us: "FBI Cyber Division, Secret Service"
          international: "Interpol, Europol, local authorities"
        what_to_provide:
          - "Incident summary"
          - "IOCs and evidence"
          - "Business impact"
          - "Attacker attribution if known"
        expectations:
          - "Investigation may be slow"
          - "Prosecution not guaranteed"
          - "Coordination on public disclosure"
          
  post_incident_activities:
    
    audience: "All levels - learning and improvement"
    
    overview: |
      Post-incident activities transform incidents from failures into organizational 
      learning. This section addresses lessons learned process, improvement tracking, 
      and knowledge sharing.
      
    post_incident_review:
      
      timing: "Within 1 week of incident closure"
      
      participants:
        required:
          - "Incident response team"
          - "IT operations"
          - "Affected business unit representatives"
        optional:
          - "Executive sponsor"
          - "External IR consultants (if engaged)"
          
      agenda:
        
        incident_overview:
          - "Timeline of events"
          - "Attack vector and attacker TTPs"
          - "Systems and data affected"
          - "Business impact"
          
        what_went_well:
          focus: "Strengths to maintain and build upon"
          examples:
            - "Rapid initial detection"
            - "Effective team coordination"
            - "Good stakeholder communication"
          tone: "Celebrate successes, recognize team effort"
          
        what_could_improve:
          focus: "Opportunities for improvement (not blame)"
          examples:
            - "Detection gap that allowed initial access"
            - "Playbook steps that were unclear"
            - "Tools or access that were missing"
          tone: "Blameless, focus on process not people"
          
        root_cause_analysis:
          - "Technical root cause (what vulnerability or gap)"
          - "Process root cause (why did gap exist)"
          - "Organizational root cause (why not prioritized)"
          
        action_items:
          categories:
            detection: "Add detection rules, improve visibility"
            prevention: "Patch vulnerabilities, deploy controls"
            response: "Update playbooks, improve procedures"
            tools: "Acquire new tools or capabilities"
          requirements:
            - "Each action has owner"
            - "Each action has due date"
            - "Each action has success criteria"
            
    improvement_tracking:
      
      action_item_management:
        tracking_system: "Jira, ServiceNow, or dedicated IR tracking tool"
        workflow:
          - "Action created with owner and due date"
          - "Weekly review of open actions"
          - "Owner provides progress updates"
          - "Closure requires validation"
        escalation:
          - "Past due items escalated to management"
          - "Monthly executive report on completion rate"
          
      validation_of_improvements:
        detection_improvements:
          - "New detection rule tested against historical data"
          - "Rule validated in next tabletop exercise"
        process_improvements:
          - "Updated playbook tested in exercise"
          - "Team trained on new procedures"
        tool_improvements:
          - "New tool deployed and integrated"
          - "Team trained on tool usage"
          
    knowledge_management:
      
      incident_database:
        purpose: "Historical record of incidents and responses"
        contents:
          - "Incident summary and timeline"
          - "IOCs and TTPs"
          - "Response actions taken"
          - "Lessons learned"
          - "Post-incident review findings"
        benefits:
          - "Reference for future similar incidents"
          - "Training material for new team members"
          - "Evidence of due diligence"
          
      runbook_updates:
        trigger: "Action item from post-incident review"
        process:
          - "Update playbook based on learnings"
          - "Peer review changes"
          - "Version control and change documentation"
          - "Communicate updates to team"
          
      knowledge_sharing:
        internal:
          - "Monthly security newsletter with incident highlights (sanitized)"
          - "Quarterly all-hands security update"
          - "IR team retrospectives"
        external:
          - "Sanitized IOCs shared with ISAC"
          - "Anonymized case studies presented at conferences"
          - "Contribution to open-source detection rules"
          
  tabletop_exercises:
    
    audience: "Level 1+ organizations practicing incident response"
    
    overview: |
      Tabletop exercises build IR muscle memory without business impact. This section 
      addresses exercise design, facilitation, scenario development, and measuring 
      exercise effectiveness.
      
    exercise_types:
      
      discussion_based:
        format: "Talk through scenario, no hands-on activity"
        duration: "2-3 hours"
        participants: "IR team, management, stakeholders"
        objectives:
          - "Familiarize team with playbooks"
          - "Identify gaps in procedures"
          - "Practice decision-making"
        cost: "Low - internal facilitation"
        
      walkthrough:
        format: "Step through playbook in detail"
        duration: "4-6 hours"
        participants: "IR team, technical staff"
        objectives:
          - "Validate playbook accuracy"
          - "Ensure technical steps are clear"
          - "Identify missing tools or access"
        cost: "Low - internal facilitation"
        
      simulation:
        format: "Hands-on exercise in test environment"
        duration: "1-2 days"
        participants: "IR team, IT operations"
        objectives:
          - "Practice forensic collection"
          - "Test containment procedures"
          - "Validate tool functionality"
        cost: "Medium - requires test environment and time"
        
      red_team_exercise:
        format: "Simulated attack by red team, blue team responds"
        duration: "Weeks to months"
        participants: "IR team, SOC, IT operations vs red team"
        objectives:
          - "Validate detection capability"
          - "Test real-world response under pressure"
          - "Identify blind spots"
        cost: "High - external red team or significant internal resources"
        
    exercise_design:
      
      scenario_selection:
        criteria:
          - "Realistic for organization's threat profile"
          - "Tests specific playbooks or capabilities"
          - "Appropriate complexity for participants"
        variety:
          - "Rotate scenarios across exercises"
          - "Cover major threat types annually"
        examples:
          - "Ransomware (most common)"
          - "Data breach"
          - "Insider threat"
          - "Supply chain compromise"
          - "Cloud account takeover"
          
      scenario_development:
        
        scenario_template:
          title: "Ransomware Incident - Manufacturing Company"
          
          initial_situation:
            time: "Monday 8:00 AM"
            scenario: "Help desk receiving calls from users unable to access files. Desktop support reports ransom notes on several workstations."
            
          injects:
            inject_1:
              time: "8:30 AM"
              scenario: "SOC identifies 50+ systems with encryption activity. Ransomware spreading rapidly."
              
            inject_2:
              time: "9:00 AM"
              scenario: "Backup team reports backup servers also encrypted. Backups offline."
              
            inject_3:
              time: "10:00 AM"
              scenario: "Attackers left note: '$5M Bitcoin, 48 hours, or data published on dark web.'"
              
            inject_4:
              time: "11:00 AM"
              scenario: "Local news station called asking about ransomware incident."
              
          discussion_questions:
            - "What are immediate containment actions?"
            - "How do we determine scope of encryption?"
            - "Who makes decision about ransom payment?"
            - "What do we tell employees? Customers? Media?"
            - "How do we recover without backups?"
            
      facilitation_techniques:
        
        facilitator_role:
          - "Present scenario and injects"
          - "Facilitate discussion, don't provide answers"
          - "Probe decisions with follow-up questions"
          - "Keep exercise moving, manage time"
          - "Document decisions and discussions"
          
        managing_participants:
          overthinkers: "Encourage decision-making with imperfect information"
          quiet_participants: "Directly ask for their input"
          dominant_participants: "Thank for input, invite others to contribute"
          sidetracked_discussions: "Table for later, refocus on scenario"
          
    measuring_exercise_effectiveness:
      
      exercise_metrics:
        participation_metrics:
          - "Participant count and roles"
          - "Attendance rate (target 90%+)"
          - "Participant engagement (observer assessment)"
          
        decision_quality:
          - "Correct decisions made"
          - "Time to make key decisions"
          - "Decisions aligned with playbooks"
          
        gap_identification:
          - "Number of gaps identified"
          - "Severity of gaps"
          - "Action items generated"
          
      post_exercise_assessment:
        participant_survey:
          questions:
            - "Exercise realism (1-5 scale)"
            - "Clarity of scenario (1-5 scale)"
            - "Confidence in IR capability after exercise (1-5 scale)"
            - "Open feedback on strengths and improvements"
            
        improvement_tracking:
          - "Action items from exercise documented"
          - "Owners assigned with due dates"
          - "Progress reviewed monthly"
          - "Completion validated before next exercise"
          
      exercise_progression:
        year_1: "Quarterly tabletop exercises, discussion-based"
        year_2: "Quarterly exercises with increasing realism, add simulation"
        year_3: "Mix of tabletops and simulations, annual red team"
        year_4: "Mature program with continuous testing"
        
  ir_metrics_and_kpis:
    
    audience: "Level 2+ organizations measuring IR effectiveness"
    
    overview: |
      IR metrics demonstrate program value and identify improvement opportunities. 
      This section addresses key performance indicators, metric collection, and 
      data-driven optimization.
      
    core_metrics:
      
      detection_metrics:
        
        mean_time_to_detect:
          definition: "Time from initial compromise to detection"
          formula: "Detection timestamp - Compromise timestamp"
          targets:
            level_1: "<7 days"
            level_2: "<24 hours"
            level_3: "<4 hours"
            level_4: "<1 hour"
          improvement_levers:
            - "Better detection rules"
            - "Threat intelligence integration"
            - "Proactive threat hunting"
            - "Reduced alert fatigue (fewer false positives)"
            
        detection_source_distribution:
          metric: "Percentage of incidents by detection source"
          ideal_distribution:
            internal_detection: ">80% (proactive)"
            user_reports: "10-15% (acceptable)"
            external_notification: "<10% (reactive, needs improvement)"
          interpretation: "High external notification rate indicates detection gaps"
          
      response_metrics:
        
        mean_time_to_acknowledge:
          definition: "Time from alert to analyst acknowledgment"
          formula: "Acknowledgment timestamp - Alert timestamp"
          target: "<15 minutes for P1, <1 hour for P2"
          
        mean_time_to_respond:
          definition: "Time from detection to first response action"
          formula: "First action timestamp - Detection timestamp"
          targets:
            level_1: "<24 hours"
            level_2: "<4 hours"
            level_3: "<1 hour"
          improvement_levers:
            - "Clear playbooks"
            - "Automated enrichment"
            - "On-call effectiveness"
            
        mean_time_to_contain:
          definition: "Time from detection to containment complete"
          formula: "Containment timestamp - Detection timestamp"
          targets:
            level_1: "<1 week"
            level_2: "<24 hours"
            level_3: "<4 hours"
          improvement_levers:
            - "Rapid decision-making"
            - "Automated containment"
            - "Clear authority"
            
        mean_time_to_recover:
          definition: "Time from detection to normal operations restored"
          formula: "Recovery timestamp - Detection timestamp"
          targets:
            level_1: "<1 month"
            level_2: "<1 week"
            level_3: "<48 hours"
          improvement_levers:
            - "Good backups"
            - "Automated recovery"
            - "Thorough eradication (prevents reinfection)"
            
      program_effectiveness_metrics:
        
        incident_volume_trends:
          metric: "Incidents per month, by severity"
          interpretation:
            increasing: "Growing attack surface or detection improvement (investigate)"
            decreasing: "Prevention working or detection degrading (validate)"
            stable: "Baseline established"
            
        incident_recurrence_rate:
          definition: "Percentage of incidents that are repeat of previous incident type"
          formula: "(Repeat incidents / Total incidents) × 100"
          target: "<10%"
          interpretation: "High recurrence indicates failure to learn from incidents"
          
        action_item_completion_rate:
          definition: "Percentage of post-incident action items completed on time"
          formula: "(Completed on time / Total action items) × 100"
          target: ">90%"
          interpretation: "Low completion indicates improvement not happening"
          
        exercise_participation_rate:
          definition: "Percentage of IR team participating in quarterly exercises"
          formula: "(Participants / IR team size) × 100"
          target: "100% annually, >80% per exercise"
          
      business_impact_metrics:
        
        financial_impact_per_incident:
          components:
            - "Response costs (internal hours, external consultants)"
            - "Business disruption (downtime, lost productivity)"
            - "Recovery costs (restoration, remediation)"
            - "Fines and legal costs"
          calculation: "Sum of all cost components"
          trend: "Decreasing over time as program matures"
          
        prevented_incidents:
          metric: "Incidents prevented through proactive measures"
          examples:
            - "Vulnerabilities patched before exploitation"
            - "Threat hunting discoveries before impact"
            - "User-reported phishing before credential theft"
          challenge: "Difficult to quantify (didn't happen)"
          approach: "Estimate based on threat intelligence and detection"
          
    metrics_dashboard:
      
      executive_dashboard:
        audience: "CISO, CIO, executives"
        refresh_rate: "Monthly"
        metrics:
          - "Incident volume by severity (trend)"
          - "Mean time to contain (trend)"
          - "Major incident summaries"
          - "Program maturity score"
          - "Comparison to industry benchmarks"
        format: "High-level, charts and trends, minimal technical detail"
        
      operational_dashboard:
        audience: "IR team, SOC analysts"
        refresh_rate: "Real-time"
        metrics:
          - "Active incidents and status"
          - "Open action items by owner"
          - "Detection source breakdown"
          - "Response time metrics (today, this week, this month)"
        format: "Detailed, actionable, drill-down capability"
        
      program_health_dashboard:
        audience: "IR manager, security leadership"
        refresh_rate: "Weekly"
        metrics:
          - "All core metrics with trends"
          - "Playbook coverage and usage"
          - "Exercise schedule and completion"
          - "Team training and certifications"
          - "Tool health and integration status"
        format: "Comprehensive view for program management"
        
    benchmarking:
      
      industry_comparisons:
        sources:
          - "Ponemon Institute breach cost studies"
          - "Verizon Data Breach Investigations Report (DBIR)"
          - "IBM Cost of a Data Breach Report"
          - "SANS IR surveys"
        metrics_to_compare:
          - "Mean time to detect"
          - "Mean time to contain"
          - "Cost per incident"
          - "Detection source distribution"
        interpretation:
          - "Better than industry = strength to maintain"
          - "Worse than industry = improvement opportunity"
          - "Account for organization size and industry differences"
          
      internal_benchmarking:
        comparison: "Current quarter vs previous quarters"
        focus: "Improvement trends over time"
        targets: "Year-over-year improvement in key metrics"

references:
  ir_frameworks:
    - "NIST SP 800-61: Computer Security Incident Handling Guide"
    - "SANS Incident Response Process"
    - "ISO/IEC 27035: Information Security Incident Management"
    - "NIST Cybersecurity Framework: Respond function"
    
  forensic_tools:
    commercial:
      - "EnCase Forensic"
      - "FTK (Forensic Toolkit)"
      - "Cellebrite (mobile forensics)"
      - "Magnet AXIOM"
    open_source:
      - "Autopsy / Sleuth Kit"
      - "Volatility (memory forensics)"
      - "Wireshark"
      - "GRR Rapid Response"
      
  threat_intelligence:
    - "MITRE ATT&CK Framework"
    - "MISP (Malware Information Sharing Platform)"
    - "STIX/TAXII (Structured Threat Information eXpression)"
    - "AlienVault OTX, VirusTotal, AbuseIPDB"
    
  regulatory_guidance:
    - "GDPR Breach Notification Guidelines"
    - "US State Breach Notification Laws Compilation"
    - "HIPAA Breach Notification Rule"
    - "PCI DSS Incident Response Requirements"
    
cross_references:
  manual_chapters:
    - chapter: "2.4"
      title: "Detection Engineering"
      relevance: "Detection feeds IR, IR feedback improves detection"
    - chapter: "3.1"
      title: "IAM at Scale"
      relevance: "Identity compromise response, credential management"
    - chapter: "4.1"
      title: "Security Automation"
      relevance: "Automated response, playbook execution, SOAR integration"
      
  vault_repositories:
    - repo: "vault-incident-response"
      description: "IR playbooks, templates, and runbooks"
      relevance: "Implementation examples for this chapter"
    - repo: "vault-detection-response"
      description: "Detection rules triggering IR workflows"
      relevance: "Detection-to-response integration"
    - repo: "vault-automation-scripts"
      description: "Automated response scripts and playbooks"
      relevance: "Response automation"
